<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Participant Journey</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', system-ui, sans-serif;
            min-height: 100vh;
            color: #182d53;
            overflow-x: hidden;
            transition: background 0.6s ease;
        }

        /* Dynamic backgrounds per stage */
        body.stage-0 { background: linear-gradient(135deg, #ffffff 0%, #f0f8ff 100%); }
        body.stage-1 { background: linear-gradient(135deg, #f8fbfd 0%, #e8f4fb 100%); }
        body.stage-2 { background: linear-gradient(135deg, #182d53 0%, #2a4a7a 100%); color: #fff; }
        body.stage-3 { background: linear-gradient(135deg, #f0f8ff 0%, #d4ecf9 100%); }
        body.stage-4 { background: linear-gradient(135deg, #86c7ed 0%, #5fb3e0 50%, #182d53 100%); color: #fff; }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header - animates with stage */
        .header {
            text-align: center;
            padding: 40px 20px 20px;
            max-width: 700px;
            margin: 0 auto;
            transition: all 0.5s ease;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: color 0.5s ease;
        }

        body.stage-2 h1,
        body.stage-4 h1 { color: #fff; }

        .subtitle {
            font-size: 1.05rem;
            line-height: 1.6;
            opacity: 0.8;
            transition: color 0.5s ease;
        }

        /* Hero container - holds stage-specific content */
        .hero-container {
            margin-bottom: 24px;
        }

        /* Stage hero areas - integrated with info panel */
        .stage-hero {
            display: none;
            padding: 0;
            animation: fadeSlideIn 0.6s ease;
        }

        .stage-hero.active {
            display: block;
        }

        @keyframes fadeSlideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Onboarding hero - cinematic video */
        .hero-video-wrapper {
            max-width: 100%;
            margin: 0 auto;
            position: relative;
        }

        .hero-video-label {
            text-align: center;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: rgba(255,255,255,0.8);
            margin-bottom: 12px;
            font-weight: 600;
        }

        .hero-video {
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            background: #000;
            position: relative;
        }

        .hero-video iframe {
            border-radius: 16px;
        }

        /* Resources hero - GIF showcase */
        .hero-gif-wrapper {
            max-width: 100%;
            margin: 0 auto;
        }

        .hero-gif-label {
            text-align: center;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #7a8fa6;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .hero-gif {
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(24, 45, 83, 0.15);
            background: #fff;
        }

        .hero-gif img {
            width: 100%;
            display: block;
            border-radius: 16px;
        }

        /* Palooza hero - screenshot wall */
        .hero-palooza {
            max-width: 100%;
            overflow: hidden;
            position: relative;
        }

        .screenshot-explosion {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            padding: 10px 0;
            max-width: 100%;
            margin: 0 auto;
        }

        .screenshot-item {
            width: 100px;
            height: 100px;
            border-radius: 10px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            animation: popIn 0.5s ease backwards;
        }

        .screenshot-item:nth-child(odd) { transform: rotate(-2deg); }
        .screenshot-item:nth-child(even) { transform: rotate(2deg); }
        .screenshot-item:nth-child(3n) { transform: rotate(-3deg) scale(1.05); }
        .screenshot-item:nth-child(5n) { transform: rotate(3deg) scale(0.95); }

        .screenshot-item:hover {
            transform: rotate(0deg) scale(1.15) !important;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.5);
            z-index: 10;
        }

        .screenshot-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        @keyframes popIn {
            from { opacity: 0; transform: scale(0.5) rotate(10deg); }
            to { opacity: 1; }
        }

        .palooza-label {
            text-align: center;
            margin-top: 20px;
            font-size: 0.9rem;
            color: rgba(255,255,255,0.9);
            font-weight: 500;
        }

        /* Journey track */
        .journey-wrapper {
            padding: 30px 20px 60px;
            max-width: 1000px;
            margin: 0 auto;
        }

        .journey-track-container {
            position: relative;
            height: 140px;
            margin-bottom: 30px;
        }

        .journey-path {
            position: absolute;
            top: 55px;
            left: 50px;
            right: 50px;
            height: 6px;
            background: rgba(134, 199, 237, 0.3);
            border-radius: 3px;
            overflow: hidden;
        }

        .journey-path-fill {
            height: 100%;
            background: linear-gradient(90deg, #86c7ed, #5fb3e0);
            border-radius: 3px;
            transition: width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 0 20px rgba(134, 199, 237, 0.6);
        }

        .stage-markers {
            position: absolute;
            top: 25px;
            left: 50px;
            right: 50px;
            display: flex;
            justify-content: space-between;
        }

        .stage-marker {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: transform 0.3s ease;
            z-index: 5;
        }

        .stage-marker:hover {
            transform: translateY(-5px) scale(1.1);
        }

        .marker-dot {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            background: #fff;
            border: 4px solid rgba(134, 199, 237, 0.4);
            box-shadow: 0 4px 15px rgba(24, 45, 83, 0.15);
            transition: all 0.4s ease;
        }

        .stage-marker.active .marker-dot {
            border-color: #86c7ed;
            box-shadow: 0 0 0 8px rgba(134, 199, 237, 0.2), 0 8px 30px rgba(134, 199, 237, 0.4);
            transform: scale(1.1);
        }

        .stage-marker.completed .marker-dot {
            background: linear-gradient(135deg, #86c7ed, #5fb3e0);
            border-color: #86c7ed;
        }

        .marker-label {
            margin-top: 10px;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.6;
            transition: all 0.3s ease;
        }

        .stage-marker.active .marker-label {
            opacity: 1;
        }

        body.stage-2 .marker-label,
        body.stage-4 .marker-label {
            color: #fff;
        }

        /* Animated dot instead of person */
        .journey-dot {
            position: absolute;
            top: 43px;
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #86c7ed, #182d53);
            border-radius: 50%;
            box-shadow: 0 0 20px rgba(134, 199, 237, 0.8), 0 0 40px rgba(134, 199, 237, 0.4);
            transition: left 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 10;
            animation: dotPulse 2s ease-in-out infinite;
        }

        @keyframes dotPulse {
            0%, 100% { box-shadow: 0 0 20px rgba(134, 199, 237, 0.8), 0 0 40px rgba(134, 199, 237, 0.4); }
            50% { box-shadow: 0 0 30px rgba(134, 199, 237, 1), 0 0 60px rgba(134, 199, 237, 0.6); }
        }

        /* Info panel */
        .info-panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 24px;
            padding: 36px;
            box-shadow: 0 10px 50px rgba(24, 45, 83, 0.12);
            backdrop-filter: blur(10px);
            transition: all 0.5s ease;
        }

        body.stage-2 .info-panel,
        body.stage-4 .info-panel {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .panel-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 20px;
        }

        .panel-icon {
            font-size: 2.5rem;
            animation: iconBounce 2s ease-in-out infinite;
        }

        @keyframes iconBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .panel-title {
            font-size: 1.6rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        body.stage-2 .panel-title,
        body.stage-4 .panel-title {
            color: #fff;
        }

        .panel-description {
            line-height: 1.8;
            font-size: 1.1rem;
            margin-bottom: 24px;
            opacity: 0.9;
        }

        body.stage-2 .panel-description,
        body.stage-4 .panel-description {
            color: rgba(255,255,255,0.9);
        }

        /* Lightbox */
        .lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(24, 45, 83, 0.97);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .lightbox.active {
            display: flex;
        }

        .lightbox-content {
            max-width: 90%;
            max-height: 90%;
            position: relative;
            animation: zoomIn 0.3s ease;
        }

        @keyframes zoomIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .lightbox-content img {
            max-width: 100%;
            max-height: 85vh;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }

        .lightbox-close {
            position: absolute;
            top: -50px;
            right: 0;
            background: none;
            border: none;
            color: #fff;
            font-size: 2.5rem;
            cursor: pointer;
            opacity: 0.7;
            transition: all 0.2s ease;
        }

        .lightbox-close:hover {
            opacity: 1;
            transform: rotate(90deg);
        }

        .lightbox-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.15);
            border: none;
            color: #fff;
            font-size: 2rem;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .lightbox-nav:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-50%) scale(1.1);
        }

        .lightbox-prev { left: -80px; }
        .lightbox-next { right: -80px; }

        /* Expandable cards */
        .deep-dives {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 28px;
            padding-top: 24px;
            border-top: 1px solid rgba(134, 199, 237, 0.3);
        }

        .deep-dives-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            opacity: 0.6;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .deep-dive-card {
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(134, 199, 237, 0.2);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        body.stage-2 .deep-dive-card,
        body.stage-4 .deep-dive-card {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .deep-dive-card:hover {
            border-color: #86c7ed;
        }

        .deep-dive-card.expanded {
            background: rgba(255, 255, 255, 0.95);
            border-color: #86c7ed;
            box-shadow: 0 8px 30px rgba(134, 199, 237, 0.2);
        }

        body.stage-2 .deep-dive-card.expanded,
        body.stage-4 .deep-dive-card.expanded {
            background: rgba(255, 255, 255, 0.15);
        }

        .deep-dive-header {
            padding: 18px 22px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
        }

        .deep-dive-title {
            font-size: 0.95rem;
            font-weight: 700;
        }

        body.stage-2 .deep-dive-title,
        body.stage-4 .deep-dive-title {
            color: #fff;
        }

        .deep-dive-preview {
            font-size: 0.8rem;
            opacity: 0.6;
            margin-top: 4px;
        }

        .deep-dive-card.expanded .deep-dive-preview {
            display: none;
        }

        .deep-dive-toggle {
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.5;
            transition: all 0.3s ease;
            font-size: 1.3rem;
        }

        .deep-dive-card.expanded .deep-dive-toggle {
            transform: rotate(180deg);
            opacity: 1;
            color: #86c7ed;
        }

        .deep-dive-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease;
        }

        .deep-dive-card.expanded .deep-dive-content {
            max-height: 600px;
            padding: 0 22px 22px;
        }

        .deep-dive-content-inner {
            line-height: 1.7;
            font-size: 0.9rem;
            opacity: 0.85;
        }

        body.stage-2 .deep-dive-content-inner,
        body.stage-4 .deep-dive-content-inner {
            color: #fff;
        }

        .deep-dive-content-inner p {
            margin-bottom: 12px;
        }

        .card-stat {
            display: flex;
            align-items: baseline;
            gap: 12px;
            margin: 16px 0;
            padding: 16px 20px;
            background: linear-gradient(135deg, rgba(134, 199, 237, 0.15), rgba(134, 199, 237, 0.05));
            border-radius: 12px;
            border-left: 4px solid #86c7ed;
        }

        .card-stat-value {
            font-size: 1.6rem;
            font-weight: 800;
            color: #182d53;
            white-space: nowrap;
        }

        body.stage-2 .card-stat-value,
        body.stage-4 .card-stat-value {
            color: #86c7ed;
        }

        .card-stat-label {
            font-size: 0.85rem;
            opacity: 0.8;
            line-height: 1.4;
        }

        /* Controls */
        .controls {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-top: 36px;
        }

        .control-btn {
            padding: 14px 32px;
            border-radius: 30px;
            font-size: 0.9rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .control-btn.primary {
            background: linear-gradient(135deg, #86c7ed, #5fb3e0);
            color: #182d53;
            box-shadow: 0 4px 20px rgba(134, 199, 237, 0.4);
        }

        .control-btn.primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(134, 199, 237, 0.6);
        }

        .control-btn.secondary {
            background: transparent;
            color: inherit;
            border: 2px solid currentColor;
            opacity: 0.7;
        }

        .control-btn.secondary:hover {
            opacity: 1;
            transform: translateY(-2px);
        }

        /* Stats footer */
        .stats-footer {
            display: flex;
            justify-content: center;
            gap: 50px;
            margin-top: 50px;
            padding-top: 40px;
            border-top: 1px solid rgba(134, 199, 237, 0.2);
            flex-wrap: wrap;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 800;
            color: #182d53;
        }

        body.stage-2 .stat-value,
        body.stage-4 .stat-value {
            color: #fff;
        }

        .stat-label {
            font-size: 0.75rem;
            opacity: 0.6;
            margin-top: 4px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero-resources {
                grid-template-columns: 1fr;
            }
            .screenshot-item {
                width: 100px;
                height: 100px;
            }
            h1 { font-size: 1.8rem; }
            .marker-dot { width: 48px; height: 48px; font-size: 1.3rem; }
        }

        @media (max-width: 600px) {
            .marker-label { display: none; }
            .stats-footer { gap: 30px; }
            .lightbox-nav { display: none; }
            .screenshot-item { width: 80px; height: 80px; }
        }
    </style>
</head>
<body class="stage-0">
    <div class="header">
        <h1>The Participant Journey</h1>
        <p class="subtitle">Follow one person through our program ‚Äî click any stage to explore, or hit play to watch the full journey unfold.</p>
    </div>

    <div class="journey-wrapper">
        <div class="journey-track-container">
            <div class="journey-path">
                <div class="journey-path-fill" id="pathFill" style="width: 0%"></div>
            </div>

            <div class="stage-markers">
                <div class="stage-marker active" data-stage="0">
                    <div class="marker-dot">üëã</div>
                    <div class="marker-label">Recruited</div>
                </div>
                <div class="stage-marker" data-stage="1">
                    <div class="marker-dot">üìù</div>
                    <div class="marker-label">Apply</div>
                </div>
                <div class="stage-marker" data-stage="2">
                    <div class="marker-dot">üöÄ</div>
                    <div class="marker-label">Onboarding</div>
                </div>
                <div class="stage-marker" data-stage="3">
                    <div class="marker-dot">üìö</div>
                    <div class="marker-label">Resources</div>
                </div>
                <div class="stage-marker" data-stage="4">
                    <div class="marker-dot">üéâ</div>
                    <div class="marker-label">Palooza</div>
                </div>
            </div>

            <div class="journey-dot" id="journeyDot"></div>
        </div>

        <!-- Stage-specific hero sections - integrated above info panel -->
        <div class="hero-container">
            <!-- Onboarding hero - cinematic video -->
            <div class="stage-hero" id="hero-onboarding">
                <div class="hero-video-wrapper">
                    <div class="hero-video-label">Watch: What's at Stake (PA 2025)</div>
                    <div class="hero-video">
                        <iframe
                            width="100%"
                            height="506"
                            src="https://www.youtube.com/embed/Yq3KO8hCWcA"
                            title="What's at Stake - PA 2025"
                            frameborder="0"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                            allowfullscreen
                            style="border-radius: 20px;">
                        </iframe>
                    </div>
                </div>
            </div>

            <!-- Resources hero - GIF showcase -->
            <div class="stage-hero" id="hero-resources">
                <div class="hero-gif-wrapper">
                    <div class="hero-gif-label">2024 Resource Hub</div>
                    <div class="hero-gif">
                        <img src="Rally Gifs resource.gif" alt="Rally platform demonstration">
                    </div>
                </div>
            </div>

            <!-- Palooza hero - screenshot explosion -->
            <div class="stage-hero" id="hero-palooza">
                <div class="hero-palooza">
                    <div class="screenshot-explosion" id="screenshotWall">
                        <!-- Filled by JS -->
                    </div>
                    <div class="palooza-label">Real messages from our 2023 Mississippi program ‚Äî click any to explore</div>
                </div>
            </div>
        </div>

        <div class="info-panel" id="infoPanel">
            <!-- Content injected by JS -->
        </div>

        <div class="controls">
            <button class="control-btn secondary" id="prevBtn">‚Üê Back</button>
            <button class="control-btn primary" id="playBtn">‚ñ∂ Play Journey</button>
            <button class="control-btn secondary" id="nextBtn">Next ‚Üí</button>
        </div>

        <div class="stats-footer">
            <div class="stat">
                <div class="stat-value">97,380</div>
                <div class="stat-label">Applied in 2024</div>
            </div>
            <div class="stat">
                <div class="stat-value">27,146</div>
                <div class="stat-label">Completed Program</div>
            </div>
            <div class="stat">
                <div class="stat-value">1,014,902</div>
                <div class="stat-label">Voters Reached</div>
            </div>
        </div>
    </div>

    <!-- Lightbox -->
    <div class="lightbox" id="lightbox">
        <div class="lightbox-content">
            <button class="lightbox-close" onclick="closeLightbox()">√ó</button>
            <button class="lightbox-nav lightbox-prev" onclick="lightboxNav(-1)">‚Äπ</button>
            <img id="lightbox-img" src="" alt="Participant screenshot">
            <button class="lightbox-nav lightbox-next" onclick="lightboxNav(1)">‚Ä∫</button>
        </div>
    </div>

    <script>
        // All screenshots - exact filenames
        const galleryImages = [
            'MS zoom chat screenshots/Screen Shot 2023-10-26 at 5.07.05 PM.png',
            'MS zoom chat screenshots/Screen Shot 2023-10-26 at 8.08.11 PM.png',
            'MS zoom chat screenshots/Screen Shot 2023-10-26 at 8.08.46 PM.png',
            'MS zoom chat screenshots/Screen Shot 2023-10-26 at 8.11.12 PM.png',
            'MS zoom chat screenshots/Screen Shot 2023-10-26 at 9.03.32 PM.png',
            'MS zoom chat screenshots/Screen Shot 2023-10-26 at 9.05.24 PM.png',
            'MS zoom chat screenshots/Screen Shot 2023-11-01 at 2.33.26 PM.png',
            'MS zoom chat screenshots/Screen Shot 2023-11-01 at 3.24.08 PM.png',
            'MS zoom chat screenshots/Screen Shot 2023-11-06 at 1.07.27 PM.png',
            'MS zoom chat screenshots/Screen Shot 2023-11-06 at 1.17.43 PM.png',
            'MS zoom chat screenshots/Screen Shot 2023-11-06 at 1.47.55 PM.png',
            'MS zoom chat screenshots/Screen Shot 2023-11-06 at 2.15.40 PM.png',
            'MS zoom chat screenshots/Screen Shot 2023-11-06 at 7.12.14 PM.png',
            'MS zoom chat screenshots/Screen Shot 2023-11-07 at 8.40.27 AM.png',
            'MS zoom chat screenshots/Screen Shot 2023-11-07 at 8.44.52 AM.png',
            'MS zoom chat screenshots/Screen Shot 2023-11-07 at 12.04.43 PM.png',
            'MS zoom chat screenshots/Screen Shot 2023-11-07 at 12.19.04 PM.png',
            'MS zoom chat screenshots/Screen Shot 2023-11-07 at 3.21.14 PM.png',
            'MS zoom chat screenshots/Screen Shot 2023-11-07 at 4.01.12 PM.png',
            'MS zoom chat screenshots/Screen Shot 2023-11-07 at 4.02.33 PM.png',
            'MS zoom chat screenshots/Screen Shot 2023-11-07 at 4.04.36 PM.png',
            'MS zoom chat screenshots/Screenshot 2023-10-29 at 3.05.11 PM.png',
            'MS zoom chat screenshots/Screenshot 2023-10-31 at 1.34.56 PM.png',
            'MS zoom chat screenshots/Screenshot 2023-11-07 at 11.41.31 AM.png',
            'MS zoom chat screenshots/Screenshot 2023-11-07 at 11.41.49 AM.png',
            'MS zoom chat screenshots/Screenshot 2023-11-07 at 12.16.45 PM.png',
            'MS zoom chat screenshots/Screenshot 2023-11-07 at 12.20.23 PM.png',
            'MS zoom chat screenshots/Screenshot 2023-11-07 at 12.21.21 PM.png',
            'MS zoom chat screenshots/Screenshot 2023-11-07 at 12.21.45 PM.png',
            'MS zoom chat screenshots/Screenshot 2023-11-07 at 12.21.58 PM.png',
            'MS zoom chat screenshots/Screenshot 2023-11-07 at 12.22.06 PM.png',
            'MS zoom chat screenshots/Screenshot 2023-11-07 at 12.22.44 PM.png',
            'MS zoom chat screenshots/Screenshot 2023-11-07 at 12.22.46 PM.png',
            'MS zoom chat screenshots/Screenshot 2023-11-07 at 12.22.55 PM.png',
            'MS zoom chat screenshots/Screenshot 2023-11-07 at 12.23.00 PM.png',
            'MS zoom chat screenshots/Screenshot 2023-11-07 at 12.23.05 PM.png',
            'MS zoom chat screenshots/Screenshot 2023-11-07 at 12.24.37 PM.png',
            'MS zoom chat screenshots/Screenshot 2023-11-07 at 12.25.42 PM.png',
            'MS zoom chat screenshots/Screenshot 2023-11-07 at 12.26.26 PM.png',
            'MS zoom chat screenshots/Screenshot 2023-11-07 at 12.26.45 PM.png',
            'MS zoom chat screenshots/Screenshot 2023-11-07 at 12.26.49 PM.png',
            'MS zoom chat screenshots/Screenshot 2023-11-07 at 3.33.42 PM.png',
            'MS zoom chat screenshots/Screenshot 2023-11-07 at 8.34.00 PM.png'
        ];

        let currentLightboxIndex = 0;

        function generateScreenshotWall() {
            const wall = document.getElementById('screenshotWall');
            wall.innerHTML = '';

            const shuffled = [...galleryImages].sort(() => Math.random() - 0.5);

            shuffled.forEach((src, i) => {
                const div = document.createElement('div');
                div.className = 'screenshot-item';
                div.style.animationDelay = `${i * 0.05}s`;

                const img = document.createElement('img');
                img.src = src;
                img.alt = 'Participant message';
                img.loading = 'lazy';
                img.onerror = () => div.style.display = 'none';

                div.appendChild(img);
                div.onclick = () => openLightbox(galleryImages.indexOf(src));
                wall.appendChild(div);
            });
        }

        const stages = [
            {
                icon: 'üëã',
                title: 'Getting Recruited',
                description: 'Someone sees our ad, gets a text, hears from a community partner, or ‚Äî most often ‚Äî gets invited by a friend who\'s already in the program. They click through to Rally and apply.',
                heroId: null,
                deepDives: [
                    {
                        label: 'Recruitment channels (2024)',
                        preview: '36.8% from referrals, 30.3% from SMS...',
                        content: `
                            <p>In 2024, we recruited through multiple channels, meeting people where they are:</p>
                            <div class="card-stat">
                                <div class="card-stat-value">36.8%</div>
                                <div class="card-stat-label">came through peer referrals ‚Äî our most effective method at $25.47 per applicant</div>
                            </div>
                            <div class="card-stat">
                                <div class="card-stat-value">30.3%</div>
                                <div class="card-stat-label">recruited via SMS (38 million texts sent)</div>
                            </div>
                            <p>We also used digital ads (25%), community partnerships (7.2%), and on-the-ground outreach. Referrals worked best in states where we'd run previous programs ‚Äî the work compounds.</p>
                        `
                    },
                    {
                        label: 'Why referrals work (2024)',
                        preview: 'Word of mouth + accountability',
                        content: `
                            <p>Referrals function like relational organizing itself ‚Äî the best marketer for our program is word of mouth from people already participating.</p>
                            <p>In 2024, we compensated participants for successful referrals. In the final referral round, we required that referrals actually <em>complete</em> the program ‚Äî which meant participants helped chase their own referrals.</p>
                            <div class="card-stat">
                                <div class="card-stat-value">28.2%</div>
                                <div class="card-stat-label">completion rate for fall referrals (vs. 17% for summer) ‚Äî accountability made the difference</div>
                            </div>
                        `
                    }
                ]
            },
            {
                icon: 'üìù',
                title: 'Applying & Getting Accepted',
                description: 'They fill out an application on Rally ‚Äî answering questions about why they want to participate. Behind the scenes, we verify them against the voter file, run fraud detection, and assign them to a hiring tier. Then a human reads their free responses before we accept them.',
                heroId: null,
                deepDives: [
                    {
                        label: 'The vetting process',
                        preview: 'Voter file matching, fraud detection, human review',
                        content: `
                            <p>Every application goes through automated review first:</p>
                            <p>‚Ä¢ Matched to the national voter file (83% auto-match rate in 2024)<br>
                            ‚Ä¢ Run through fraud detection<br>
                            ‚Ä¢ Assigned to one of 5 hiring tiers based on vote propensity, support scores, location, and answers</p>
                            <p>Then a team of humans manually reviews each application and reads free responses before accepting.</p>
                            <div class="card-stat">
                                <div class="card-stat-value">79.4%</div>
                                <div class="card-stat-label">of applicants were accepted in 2024</div>
                            </div>
                        `
                    },
                    {
                        label: 'Why speed matters (2024)',
                        preview: '60%+ signed up within 48 hours',
                        content: `
                            <p>In 2024, we learned that speed of acceptance was a major driver of conversion. The faster someone was accepted after applying, the more likely they were to complete the program.</p>
                            <div class="card-stat">
                                <div class="card-stat-value">>60%</div>
                                <div class="card-stat-label">of accepted applicants signed up for onboarding within 48 hours</div>
                            </div>
                            <p>Same-day event scheduling reduced flaking by up to 20% vs. scheduling for a future date.</p>
                        `
                    }
                ]
            },
            {
                icon: 'üöÄ',
                title: 'Attending Onboarding',
                description: 'They get a magic link via text and email that signs them into Rally and opens Zoom in one click. Staff welcome them, they watch a state-specific voter education video, sign their contract, make their own vote plan, and schedule their Palooza ‚Äî all on the call.',
                heroId: 'hero-onboarding',
                deepDives: [
                    {
                        label: 'What happens on the call',
                        preview: '1 hour: welcome, video, contract, schedule',
                        content: `
                            <p>Onboarding is a 1-hour Zoom event hosted by our Mobilization Events team:</p>
                            <p>1. Staff welcome participants<br>
                            2. State-specific voter education video (20 min)<br>
                            3. Discussion: why did you become a Voting Ambassador?<br>
                            4. Sign contract in Rally<br>
                            5. Schedule Palooza event</p>
                            <div class="card-stat">
                                <div class="card-stat-value">85%+</div>
                                <div class="card-stat-label">signed their contract live on the call in 2024</div>
                            </div>
                        `
                    },
                    {
                        label: 'Our 90 event leads (2024)',
                        preview: 'Mostly performers ‚Äî recruited from Playbill',
                        content: `
                            <p>In 2024, we hired 90 non-traditional organizers as part-time event leads ‚Äî primarily from the performing arts community.</p>
                            <p>Performers bring energy through a Zoom screen, handle last-minute changes, and connect authentically. We recruited from Playbill.com and similar platforms.</p>
                            <div class="card-stat">
                                <div class="card-stat-value">1,329</div>
                                <div class="card-stat-label">total events run across 5 states in 2024</div>
                            </div>
                        `
                    }
                ]
            },
            {
                icon: 'üìö',
                title: 'Accessing Resources & Support',
                description: 'Now they have everything they need: a hub tailored to their state with conversation guides, sample dialogues, videos, and voting info. And when they have questions, our textline team is there 12 hours a day ‚Äî ready to help, cheer them on, or even call their secretary of state.',
                heroId: 'hero-resources',
                deepDives: [
                    {
                        label: 'The resource hub (2024)',
                        preview: '50,000+ visitors to state-specific content',
                        content: `
                            <p>Every participant gets access to a resource website tailored to their state:</p>
                            <p>‚Ä¢ Voting information and deadlines<br>
                            ‚Ä¢ Digital materials to share with friends<br>
                            ‚Ä¢ Tips for tough conversations with sample dialogues</p>
                            <div class="card-stat">
                                <div class="card-stat-value">50,000+</div>
                                <div class="card-stat-label">unique visitors to the resource site in 2024</div>
                            </div>
                        `
                    },
                    {
                        label: 'Live textline support',
                        preview: '12 hours/day ‚Äî we called secretaries of state',
                        content: `
                            <p>In 2024, our Support team handled texts and emails from 11am-11pm ET every day.</p>
                            <p>They answered questions about Rally, voting, and the program. They cheered people on. And yes ‚Äî they called secretaries of state on behalf of participants who needed help.</p>
                        `
                    }
                ]
            },
            {
                icon: 'üéâ',
                title: 'Palooza!',
                description: 'They join their Palooza ‚Äî a one-hour virtual work session where they do live outreach to friends and family with support from our event leads. If someone needs extra help, our system spots it and moves them to a breakout room for small-group coaching.',
                heroId: 'hero-palooza',
                deepDives: [
                    {
                        label: 'The Palooza experience',
                        preview: 'Live outreach with support',
                        content: `
                            <p>Paloozas are one-hour virtual work sessions where participants do their actual outreach ‚Äî texting and calling their contacts ‚Äî with support from event leads.</p>
                            <div class="card-stat">
                                <div class="card-stat-value">87,792</div>
                                <div class="card-stat-label">individual event attendances in 2024</div>
                            </div>
                        `
                    },
                    {
                        label: 'What participants accomplished (2024)',
                        preview: '44 contacts each, 84% voted or made a plan',
                        content: `
                            <p>In 2024, participants mapped their contacts in Rally, talked to them about voting, and helped them make plans.</p>
                            <div class="card-stat">
                                <div class="card-stat-value">44.1</div>
                                <div class="card-stat-label">average contacts per completed participant</div>
                            </div>
                            <div class="card-stat">
                                <div class="card-stat-value">84%</div>
                                <div class="card-stat-label">of contacts voted early or made a vote plan</div>
                            </div>
                        `
                    }
                ]
            }
        ];

        let currentStage = 0;
        let isPlaying = false;
        let playInterval = null;

        const journeyDot = document.getElementById('journeyDot');
        const pathFill = document.getElementById('pathFill');
        const infoPanel = document.getElementById('infoPanel');
        const markers = document.querySelectorAll('.stage-marker');
        const playBtn = document.getElementById('playBtn');

        function getDotPosition(index) {
            const marker = markers[index];
            const container = document.querySelector('.journey-track-container');
            const markerRect = marker.getBoundingClientRect();
            const containerRect = container.getBoundingClientRect();
            return markerRect.left - containerRect.left + (markerRect.width / 2) - 15;
        }

        function openLightbox(index) {
            currentLightboxIndex = index;
            const lightbox = document.getElementById('lightbox');
            const img = document.getElementById('lightbox-img');
            img.src = galleryImages[index];
            lightbox.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeLightbox() {
            document.getElementById('lightbox').classList.remove('active');
            document.body.style.overflow = '';
        }

        function lightboxNav(delta) {
            currentLightboxIndex = (currentLightboxIndex + delta + galleryImages.length) % galleryImages.length;
            document.getElementById('lightbox-img').src = galleryImages[currentLightboxIndex];
        }

        document.getElementById('lightbox').addEventListener('click', (e) => {
            if (e.target.id === 'lightbox') closeLightbox();
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeLightbox();
            if (document.getElementById('lightbox').classList.contains('active')) {
                if (e.key === 'ArrowLeft') lightboxNav(-1);
                if (e.key === 'ArrowRight') lightboxNav(1);
            }
        });

        function updateStage(newStage, animate = true) {
            currentStage = newStage;
            const stage = stages[currentStage];

            // Update body class for dynamic background
            document.body.className = `stage-${currentStage}`;

            // Update hero sections
            document.querySelectorAll('.stage-hero').forEach(hero => hero.classList.remove('active'));
            if (stage.heroId) {
                const hero = document.getElementById(stage.heroId);
                if (hero) hero.classList.add('active');
            }

            // Update journey dot position
            journeyDot.style.left = getDotPosition(currentStage) + 'px';

            // Update path fill
            pathFill.style.width = `${(currentStage / (stages.length - 1)) * 100}%`;

            // Update markers
            markers.forEach((marker, index) => {
                marker.classList.remove('active', 'completed');
                if (index < currentStage) marker.classList.add('completed');
                else if (index === currentStage) marker.classList.add('active');
            });

            // Build info panel
            let deepDiveHtml = '';
            if (stage.deepDives && stage.deepDives.length > 0) {
                deepDiveHtml = `
                    <div class="deep-dives">
                        <div class="deep-dives-label">Learn more</div>
                        ${stage.deepDives.map((dd, i) => `
                            <div class="deep-dive-card" data-index="${i}">
                                <div class="deep-dive-header">
                                    <div>
                                        <div class="deep-dive-title">${dd.label}</div>
                                        <div class="deep-dive-preview">${dd.preview}</div>
                                    </div>
                                    <div class="deep-dive-toggle">‚ñæ</div>
                                </div>
                                <div class="deep-dive-content">
                                    <div class="deep-dive-content-inner">${dd.content}</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            infoPanel.innerHTML = `
                <div class="panel-header">
                    <div class="panel-icon">${stage.icon}</div>
                    <div class="panel-title">${stage.title}</div>
                </div>
                <div class="panel-description">${stage.description}</div>
                ${deepDiveHtml}
            `;

            // Attach expandable card handlers
            document.querySelectorAll('.deep-dive-card').forEach(card => {
                card.querySelector('.deep-dive-header').addEventListener('click', () => {
                    const wasExpanded = card.classList.contains('expanded');
                    document.querySelectorAll('.deep-dive-card').forEach(c => c.classList.remove('expanded'));
                    if (!wasExpanded) card.classList.add('expanded');
                });
            });
        }

        function nextStage() {
            if (currentStage < stages.length - 1) updateStage(currentStage + 1);
            else if (isPlaying) stopPlaying();
        }

        function prevStage() {
            if (currentStage > 0) updateStage(currentStage - 1);
        }

        function startPlaying() {
            isPlaying = true;
            playBtn.textContent = '‚è∏ Pause';
            if (currentStage === stages.length - 1) updateStage(0);
            playInterval = setInterval(() => {
                if (currentStage < stages.length - 1) nextStage();
                else stopPlaying();
            }, 3500);
        }

        function stopPlaying() {
            isPlaying = false;
            playBtn.textContent = '‚ñ∂ Play Journey';
            if (playInterval) { clearInterval(playInterval); playInterval = null; }
        }

        document.getElementById('nextBtn').addEventListener('click', () => { stopPlaying(); nextStage(); });
        document.getElementById('prevBtn').addEventListener('click', () => { stopPlaying(); prevStage(); });
        playBtn.addEventListener('click', () => { isPlaying ? stopPlaying() : startPlaying(); });

        markers.forEach((marker, index) => {
            marker.addEventListener('click', () => { stopPlaying(); updateStage(index); });
        });

        document.addEventListener('keydown', (e) => {
            if (document.getElementById('lightbox').classList.contains('active')) return;
            if (e.key === 'ArrowRight') { stopPlaying(); nextStage(); }
            if (e.key === 'ArrowLeft') { stopPlaying(); prevStage(); }
            if (e.key === ' ') { e.preventDefault(); isPlaying ? stopPlaying() : startPlaying(); }
        });

        // Initialize
        window.addEventListener('load', () => {
            generateScreenshotWall();
            setTimeout(() => updateStage(0, false), 100);
        });

        window.addEventListener('resize', () => {
            journeyDot.style.left = getDotPosition(currentStage) + 'px';
        });
    </script>
</body>
</html>
